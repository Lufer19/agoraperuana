<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Videos - Ágora Peruana</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header>
    <h1>Videos Filosóficos</h1>
    <nav>
      <a href="index.html">Inicio</a>
      <a href="articulos.html">Artículos</a>
      <a href="definiciones.html">Definiciones</a>
      <a href="tests.html">Tests</a>
      <a href="juegos.html">Juegos</a>
      <a href="podcast.html">Podcast</a>
      <a href="videos.html">Videos</a>
      <a href="enlaces.html">Explorar</a>
    </nav>
  </header>

  <main>
    <h2>Explora nuestros videos</h2>
    <input id="ytUrl" placeholder="Pega el link de YouTube">
    <button onclick="agregarVideo()">Agregar video</button>
    <div id="preview"></div>
    <hr>
    <div id="listaVideos"></div>
  </main>

  <script>
    let videos = [];

    // Cargar lista desde JSON
    fetch('content/videos.json')
      .then(r => r.json())
      .then(data => {
        videos = data;
        renderVideos();
      });

    function getVideoId(url) {
      const m = url.match(/(?:v=|youtu\.be\/)([A-Za-z0-9_-]{11})/);
      return m ? m[1] : null;
    }

    function agregarVideo() {
      const url = document.getElementById('ytUrl').value.trim();
      const id = getVideoId(url);
      if (!id) { alert('Link inválido'); return; }

      const nuevo = {
        "titulo": "Nuevo video",
        "url": url,
        "embed": `https://www.youtube.com/embed/${id}`,
        "tags": ["filosofía"]
      };

      // Mostrar preview
      document.getElementById('preview').innerHTML =
        `<iframe width="560" height="315" src="${nuevo.embed}" frameborder="0" allowfullscreen></iframe>`;

      // Mostrar en consola para copiar en videos.json
      console.log('Agrega este objeto en content/videos.json:', nuevo);
      alert('Se generó el embed. Copia el objeto mostrado en consola y pégalo en videos.json.');
    }

    function renderVideos() {
      document.getElementById('listaVideos').innerHTML =
        videos.map(v => `
          <article>
            <h3>${v.titulo}</h3>
            <iframe width="560" height="315" src="${v.embed}" frameborder="0" allowfullscreen></iframe>
            <p><em>${(v.tags||[]).join(', ')}</em></p>
          </article>
        `).join('');
    }
  </script>
</body>
</html>
